<!DOCTYPE HTML>
<html ng-app="app">
  <head>
    <!-- <link href="/static/css/pages/pg_list_order.css" rel="stylesheet" type="text/css"> -->
    <t:layout.header title="订单查询" ng="true" css="2"/>

    <!-- import ngc js -->
    <script type="text/javascript" src="/static/ngc/order-close-button.js"></script>
  </head>
  <body ng-controller="ctrl">
    
    <t:layout.headernav />
    
    <div class="container">
      <t:layout.leftnav CurPage="/order/query" />

      <div class="main_content">
        <!-- Search Form -->
        <form method="POST" id="SearchForm" t:id="SearchForm" name="SearchForm"
              class="search_form ng-cloak" ng-submit="submit()" novalidate>
          <input type="hidden" name="t:id" value="SearchForm" />
          <input type="hidden" name="Tab" value="{{.Tab}}" />

		  <h2>订单查询</h2>
		  <div class="search_filter">
            <div class="flt_line">
              下单时间:
              从 <input class="inp_calendar" type="date"
                        name="TimeFrom" value="{{.TimeFrom | smartvaliddate}}" />  
              到 <input class="inp_calendar" type="date"
                        name="TimeTo" value="{{.TimeTo | smartvaliddate}}" />
              
              <input type="submit" value="搜索" class="btn_a_s" />
              <input t:type="a" event="ClearForm" label="清除" class="btn_b_s" />
              
              <span style="margin-left:20px;">
                <a href="###">今天</a> ,
                <a href="###">一周</a> ,
                <a href="###">一月</a> ,
                <a href="###">一年</a> Todo 
              </span>
            </div>

            <div class="flt_line">
              <span class="txt_c">日期格式： <strong>'2012-09-30'</strong>.</span>
            </div>
            <div class="flt_line"> 
            </div>
          </div>

          <div>&nbsp;</div>
          
          <div class="tab_main">
            <div class="bg">
	          <ul class="clearfix">
	            <li class="{{$.TabStyle `all`}}">
                  <a href="javascript:void(0)" onclick="ontab('all')">全部订单</a>
                </li>
	            <li class="{{$.TabStyle `toprint`}}">
                  <a href="javascript:void(0)" onclick="ontab('toprint')">待打印订单</a>
                </li>
                <li class="{{$.TabStyle `todeliver`}}">
                  <a href="javascript:void(0)" onclick="ontab('todeliver')">待发货订单</a>
                </li>
	            <li class="{{$.TabStyle `delivering`}}">
                  <a href="javascript:void(0)" onclick="ontab('delivering')">已发货订单</a>
                </li>
	            <li class="{{$.TabStyle `done`}}">
                  <a href="javascript:void(0)" onclick="ontab('done')">已完成订单</a>
                </li>
	            <li class="{{$.TabStyle `canceled`}}">
                  <a href="javascript:void(0)" onclick="ontab('canceled')">已取消订单</a>
                </li>
	          </ul>
	        </div>
          </div>

        </form>
        <!-- End Search Form -->
      </div>
      
      <div class="main_content">

        <div class="list_order">
          <t:order.list tid="orderlist" orders=".Orders" tab=".Tab" Referer="refer ."/>

          <div style="border:solid 0px red">
            <div t:type="ui.pager" total=".Total" current=".Current" pageitems=".PageItems"
                 urlTemplate=".UrlTemplate" />
          </div>
        </div>
        
      </div>
    </div>

    <!-- 这是order-close-button 这个ngc所诉要用到的模板，暂时放到这里，因为不知道怎么加载最好！ -->
    <script type="text/template" id="order-close-button-template">
  <a href="#order-close-button-modal" data-toggle-x="modal"
ng-click="closeclick($event)">结款</a>
    </script>

    <div id="order-close-button-modal" class="layer_box modal hide fade">
      <div class="layer_top modal-header">
        <a class="layer_close" title="关闭" href="#" data-dismiss="modal" aria-hidden="true"></a>
        <span>快速结款</span>
      </div>
      <div class="layer_content L_fast_cash modal-body">
        <form action="/order/ButtonSubmitHere" method="POST"
              ___onsubmit="return validateCloseForm('');">
          <input type="hidden" name="t:id" value="CloseForm" />
          <input type="hidden" name="TrackNumber" value="" class="tracking-number" />
          <input type="hidden" name="Referer" value="" class="referer"/>
          
          <div class="L_account_info clearfix">
            <strong class="customer-name"></strong>
            <span class="L_overage">
              账户余额：
              <span class="price account-ballance"></span> 元
            </span>
          </div>
          <div class="form_main">
            <dl class="clearfix">
              <dt class="L_order_price">订单金额：</dt>
              <dd>
                <strong class="price sum-order-price"></strong> 元
              </dd>
            </dl>
            <dl class="clearfix">
              <dt>结账：</dt>
              <dd>
                <input type="text" size="16" class="money" name="Money" value=""> 
                <label><input type="checkbox" class="money-clear"> 已结清</label>
              </dd>
            </dl>
            <dl class="clearfix">
              <dd>
                <input type="submit" class="btn_a_s confirm" value="确认" />
              </dd>
            </dl>
          </div>
        </form>
      </div>
    </div>
    

    <script language="javascript">
  function ontab(tab){
    var formobj = $('#SearchForm');
    if (formobj){
      var inputobj = formobj.find('input[name="Tab"]')
      if(inputobj){
        inputobj.val(tab);
        formobj.submit();
      }
    }
  }

// 这里可能并不需要一个controller，directive可以独立工作的；
angular.module('app')
// test control and test data;
  .controller("ctrl", function ($scope) {
    $scope.products = [
      { name: "Apples", category: "Fruit", price: 1.20, expiry: 10 },
      { name: "Bananas", category: "Fruit", price: 2.42, expiry: 7 },
      { name: "Pears", category: "Fruit", price: 2.02, expiry: 6 }
    ];
    $scope.submit = function(form) {
      fillFormNameWithNGModel(SearchForm);
      SearchForm.submit();
    };
  })

    </script>

  </body>
</html>
